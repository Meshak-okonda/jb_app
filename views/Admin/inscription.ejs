<%- include('../Includes/begin.ejs') %>

  <div class="container-fluid">

    <div id="wrapper">

      <%- include('../Includes/admin_nav.ejs') %>

        <section id="content-wrapper">
          <main role="main" class="pt-5 main">

            <div class="main-content">
              <div class="header pb-4 pb-sm-8 pt-5 pt-lg-8 d-flex align-items-center"
                style="height: 100px; background-size: cover; background-position: center top;">

              </div>
              <div class="container-fluid mt--7 pb-5">
                <div class="row">
                  <div id="id_inscription" style="color: white !important">
                    <%= results.id %>
                  </div>
                  <div class="col-xl-12 order-xl-1">
                    <% switch(results.status) { case 'progress' : %>
                      <div class="container-fluid landingpage">
                        <div class="nameblock">
                          <h1 class="text-center"> Cette inscription est
                            <span class="icon-like" style="color: red">en attente d'évalution</span>
                          </h1>
                        </div>
                        <div>
                          <div>
                            Nom: <strong>
                              <%= results.name %>
                            </strong>
                          </div>
                          <div>
                            Prenom: <strong>
                              <%= results.last_name %>
                            </strong>
                          </div>
                          <div>
                            E-mail: <strong>
                              <%= results.email %>
                            </strong>
                          </div>
                          <div>
                            Adresse: <strong>
                              <%= results.adress %>
                            </strong>
                          </div>
                          <div>
                            voir le diplome: <a href="/files/<%= results.diplome_name %>" target="_blank">
                              Le lien
                            </a>
                          </div>
                        </div>
                        <br />
                        <div>
                          <label for="select">Votre decision</label>
                          <select class="form-select" id="select" aria-label="Default select example"
                            style="max-width: 200px;" required>
                            <option value="accepted">Admis</option>
                            <option value="not_accepted">Non Admis</option>
                          </select>
                        </div>
                        <br />
                        <div class="form-floating">
                          <textarea class="form-control" id="remarque" placeholder="Commentaire"
                            style="max-width: 400px; height: 100px" required></textarea>
                          <label for="remarque">Votre commantaire</label>
                        </div>
                        <br>
                        <div style="display: flex; justify-content: center">
                          <button type="button" id="envoyer" class="btn btn-primary btn-lg">Envoyer</button>
                        </div>
                      </div>
                  </div>
                  <% break; %>
                    <%case 'accepted' : %>
                      <div class="container-fluid landingpage">
                        <div class="nameblock">

                          <h1 class="text-center"> Votre souscription est :
                            <span class="icon-like" style="color: red">Acceptée</span>
                          </h1>
                        </div>
                        <div>
                          <div>
                            Nom: <strong>
                              <%= results.name %>
                            </strong>
                          </div>
                          <div>
                            Prenom: <strong>
                              <%= results.last_name %>
                            </strong>
                          </div>
                          <div>
                            E-mail: <strong>
                              <%= results.email %>
                            </strong>
                          </div>
                          <div>
                            Adresse: <strong>
                              <%= results.adress %>
                            </strong>
                          </div>
                          <div>
                            voir le diplome: <a href="/files/<%= results.diplome_name %>" target="_blank">
                              Le lien
                            </a>
                          </div>
                        </div>
                      </div>
                      <% break; %>
                        <% case 'not_accepted' : %>
                          <div class="container-fluid landingpage">
                            <div class="nameblock">

                              <h1 class="text-center"> Votre souscription est :
                                <span class="icon-like" style="color: red">Non Acceptée</span>
                              </h1>
                            </div>
                            <div>
                              <div>
                                Nom: <strong>
                                  <%= results.name %>
                                </strong>
                              </div>
                              <div>
                                Prenom: <strong>
                                  <%= results.last_name %>
                                </strong>
                              </div>
                              <div>
                                E-mail: <strong>
                                  <%= results.email %>
                                </strong>
                              </div>
                            </div>
                          </div>
                          <% break; %>
                            <% } %>
                </div>
              </div>
            </div>
    </div>




    </main>
    </section>

  </div>

  </div><!-- template scripts -->
  <script src="assets/js/theme.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
    crossorigin="anonymous"></script>
  <link rel="stylesheet" href="CSS/admin-dashboard.css">
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
    integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous">
    </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous">
    </script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous">
    </script>
  <script src="assets/js/jquery.min.js"></script>
  <script src="assets/js/bootstrap.bundle.min.js"></script>
  <script src="assets/js/owl.carousel.min.js"></script>
  <script src="assets/js/waypoints.min.js"></script>
  <script src="assets/js/jquery.counterup.min.js"></script>
  <script src="assets/js/TweenMax.min.js"></script>
  <script src="assets/js/wow.js"></script>
  <script src="assets/js/jquery.magnific-popup.min.js"></script>
  <script src="assets/js/countdown.min.js"></script>
  <script src="assets/js/vegas.min.js"></script>
  <script src="assets/js/jquery.validate.min.js"></script>
  <script src="assets/js/jquery.ajaxchimp.min.js"></script>

  <%- include('../Includes/admin_end.ejs') %>

    <script>
      $('#envoyer').on("click", function () {
        const id = $("#id_inscription").text().trim();
        const status = $("#select").val();
        const remarque = $("#remarque").val()
        const url = `http://localhost:5000/inscriptions/${id}`;
        const data = {
          status: status,
          remarque: remarque
        };

        fetch(url, {
          method: "PUT",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(data)
        })
          .then(response => response)
          .then(data => {
            console.log("La requête a réussi : ", data);
          })
          .catch(error => {
            console.log(error)
            console.log("La requête a échoué : ", error);
          });
      })
    </script>